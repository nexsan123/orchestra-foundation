# 🎼 Orchestra 框架逻辑可视化

> 从用户角度梳理整个编程体系
> 版本：v1.0
> 更新：2026-01-24

---

## 一、系统全景图

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                              🎼 Orchestra AI 编程框架                               │
│                                                                                     │
│  ┌───────────────────────────────────────────────────────────────────────────────┐ │
│  │                              👤 用户（皇上）                                    │ │
│  │                                                                               │ │
│  │   可以做的事：                                                                │ │
│  │   • 提出新项目需求        • 报告 Bug           • 咨询项目细节                 │ │
│  │   • 要求功能迭代          • 查询进度           • 确认/拒绝方案                │ │
│  │   • 要求项目重构          • 提出修改意见       • 同时管理多个项目             │ │
│  │                                                                               │ │
│  └───────────────────────────────────────────────────────────────────────────────┘ │
│                                          │                                          │
│                                          ▼                                          │
│  ┌───────────────────────────────────────────────────────────────────────────────┐ │
│  │                         🎼 Conductor Agent（内阁首辅）                         │ │
│  │                                                                               │ │
│  │   唯一对接人：所有用户请求都先到这里                                          │ │
│  │                                                                               │ │
│  │   ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐   │ │
│  │   │理解意图 │→│分析类型 │→│路由分发 │→│监控进度 │→│处理异常 │→│汇报结果 │   │ │
│  │   └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘   │ │
│  │                                                                               │ │
│  └───────────────────────────────────────────────────────────────────────────────┘ │
│                                          │                                          │
│            ┌─────────────┬───────────────┼───────────────┬─────────────┐           │
│            ▼             ▼               ▼               ▼             ▼           │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│  │  Plan Agent  │ │  Spec Agent  │ │  Code Agent  │ │  Test Agent  │ │ Review Agent │
│  │   翰林院学士  │ │   工部尚书   │ │   工部侍郎   │ │   工部主事   │ │  都察院御史  │
│  │              │ │              │ │              │ │              │ │              │
│  │  需求采集    │ │  技术设计    │ │  代码实现    │ │  质量验收    │ │  审查说明    │
│  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘
│            │             │               │               │             │           │
│            └─────────────┴───────────────┴───────────────┴─────────────┘           │
│                                          │                                          │
│                                          ▼                                          │
│  ┌───────────────────────────────────────────────────────────────────────────────┐ │
│  │                              🛠️ Skills（辅助能力）                             │ │
│  │                                                                               │ │
│  │   📜 史官        🔭 钦天监       📐 将作监       🔒 契约守卫                   │ │
│  │   记录存档      扫描分析       模块规划       契约锁定                        │ │
│  │                                                                               │ │
│  │   💻 Coder Skills: shared / backend / web / mobile / desktop                  │ │
│  │                                                                               │ │
│  └───────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 二、用户交互入口分类

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                            用户可以说什么？系统怎么响应？                            │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                           🆕 新项目请求                                      │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                             │   │
│  │  用户说：                          系统响应：                               │   │
│  │  • "帮我做一个电商系统"            → 启动完整流程                           │   │
│  │  • "开发一个 TODO App"             → Plan → Spec → Code → Test → Review     │   │
│  │  • "从零开始做个博客"              → 全阶段执行                             │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                           🔄 功能迭代请求                                    │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                             │   │
│  │  用户说：                          系统响应：                               │   │
│  │  • "给这个项目加个搜索功能"        → 评估影响范围                           │   │
│  │  • "优化一下登录性能"              → 判断从哪个阶段开始                     │   │
│  │  • "改一下这个按钮的逻辑"          → 可能跳过 Plan/Spec 直接 Code           │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                           🐛 Bug 报告                                        │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                             │   │
│  │  用户说：                          系统响应：                               │   │
│  │  • "登录功能有 bug"                → 分析问题层面                           │   │
│  │  • "这里报错了"                    → 代码层？测试层？设计层？需求层？       │   │
│  │  • "功能不正常"                    → 路由到对应 Agent 修复                  │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                           ❓ 咨询问题                                        │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                             │   │
│  │  用户说：                          系统响应：                               │   │
│  │  • "这个项目是做什么的？"          → Review Agent 项目说明                  │   │
│  │  • "解释一下这段代码"              → 从简单到详细，逐层深入                 │   │
│  │  • "数据是怎么流转的？"            → 上下游分析 + 可视化图表                │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                           📊 进度查询                                        │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                             │   │
│  │  用户说：                          系统响应：                               │   │
│  │  • "现在进展怎样？"                → Conductor 直接回答进度                 │   │
│  │  • "做到哪了？"                    → 显示当前阶段和进度条                   │   │
│  │  • "还要多久？"                    → 预估剩余工作量                         │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                           😤 投诉/不满                                       │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                             │   │
│  │  用户说：                          系统响应：                               │   │
│  │  • "这不是我要的！"                → 分析差异原因                           │   │
│  │  • "做得不对"                      → 确定责任 Agent                         │   │
│  │  • "和我说的不一样"                → 提出修正方案，请用户确认               │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 三、新项目完整流程（用户视角）

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              新项目开发：用户体验流程                                │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 0: 项目启动                                                                   │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  👤 用户: "帮我做一个任务管理 App"                                                  │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "启奏皇上，微臣已接到旨意。                                                     │
│      项目名称: 任务管理 App                                                         │
│      项目类型: 新建项目                                                             │
│      项目 ID: PRJ-001                                                               │
│                                                                                     │
│      即将委派翰林院学士进行需求采访，请皇上确认是否开始？"                          │
│                                                                                     │
│  👤 用户: "开始吧"                                                                  │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 1: 需求采访（Plan Agent）                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  📋 Plan Agent:                                                                     │
│     "启奏皇上，微臣翰林院学士，奉旨采访需求。"                                      │
│                                                                                     │
│     第 1 轮 - WHAT（做什么）:                                                       │
│     "请问这个任务管理 App 主要给谁用？个人还是团队？"                               │
│                                                                                     │
│  👤 用户: "个人用的，简单一点"                                                      │
│                                                                                     │
│  📋 Plan Agent:                                                                     │
│     "需要哪些核心功能？比如：                                                       │
│      - 创建/编辑/删除任务                                                           │
│      - 设置截止日期                                                                 │
│      - 任务分类/标签                                                                │
│      - 提醒功能"                                                                    │
│                                                                                     │
│  👤 用户: "创建删除、截止日期、简单分类就行"                                        │
│                                                                                     │
│     ... (继续 2-4 轮采访) ...                                                       │
│                                                                                     │
│  📋 Plan Agent:                                                                     │
│     "启奏皇上，需求采访完成，以下是需求摘要：                                       │
│                                                                                     │
│      【Plan Report 摘要】                                                           │
│      目标用户: 个人                                                                 │
│      核心功能:                                                                      │
│        P0: 任务 CRUD、截止日期                                                      │
│        P1: 任务分类                                                                 │
│      技术偏好: Web 应用                                                             │
│                                                                                     │
│      请皇上确认是否准确？"                                                          │
│                                                                                     │
│  👤 用户: "确认"                                                                    │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 2: 技术设计（Spec Agent）                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  📐 Spec Agent:                                                                     │
│     "启奏皇上，微臣工部尚书，奉旨进行技术设计。                                     │
│                                                                                     │
│      【技术方案草案】                                                               │
│      前端: React + TypeScript                                                       │
│      后端: Node.js + Express                                                        │
│      数据库: SQLite                                                                 │
│                                                                                     │
│      【模块划分】                                                                   │
│      - task-service: 任务核心逻辑                                                   │
│      - category-service: 分类管理                                                   │
│      - ui-components: 界面组件                                                      │
│                                                                                     │
│      【契约层定义】                                                                 │
│      interface Task {                                                               │
│        id: string;                                                                  │
│        title: string;                                                               │
│        dueDate?: Date;                                                              │
│        categoryId?: string;                                                         │
│        completed: boolean;                                                          │
│      }                                                                              │
│                                                                                     │
│      请皇上过目。"                                                                  │
│                                                                                     │
│  👤 用户: "可以"                                                                    │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 3A: 契约层开发（Code Agent Phase A）                                          │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  💻 Code Agent:                                                                     │
│     "启奏皇上，微臣工部侍郎，开始创建契约层..."                                     │
│                                                                                     │
│     [创建类型定义、接口签名、API 契约]                                              │
│     [编译验证: 0 错误, 0 警告]                                                      │
│                                                                                     │
│     "契约层已完成，请工部主事验收。"                                                │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 3A-Test: 契约验收（Test Agent）                                               │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🧪 Test Agent:                                                                     │
│     "启奏皇上，契约层验收通过。                                                     │
│      - 类型定义完整 ✅                                                              │
│      - 接口签名正确 ✅                                                              │
│      - 编译无错误 ✅                                                                │
│                                                                                     │
│      🔒 契约已锁定，后续不可修改。"                                                 │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 3B: 实现层开发（Code Agent Phase B）                                          │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  💻 Code Agent:                                                                     │
│     "启奏皇上，开始填充实现层..."                                                   │
│                                                                                     │
│     [实现业务逻辑、UI 组件、数据库操作]                                             │
│     [编译验证: 0 错误]                                                              │
│                                                                                     │
│     "实现层已完成，请工部主事进行最终验收。"                                        │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 4: 最终验收（Test Agent）                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🧪 Test Agent:                                                                     │
│     "启奏皇上，最终验收报告：                                                       │
│                                                                                     │
│      编译检查: ✅ 通过                                                              │
│      类型检查: ✅ 通过                                                              │
│      功能验收:                                                                      │
│        - 创建任务 ✅                                                                │
│        - 删除任务 ✅                                                                │
│        - 设置截止日期 ✅                                                            │
│        - 任务分类 ✅                                                                │
│                                                                                     │
│      质量评分: 92/100                                                               │
│      结论: PASS，交付都察院审查。"                                                  │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 5: 代码审查（Review Agent）                                                   │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🔍 Review Agent:                                                                   │
│     "启奏皇上，微臣都察院御史，审查报告如下：                                       │
│                                                                                     │
│      【审查结论】                                                                   │
│      整体评分: 88/100                                                               │
│                                                                                     │
│      ✅ 通过项:                                                                     │
│      - 代码结构清晰                                                                 │
│      - 类型定义完整                                                                 │
│      - 功能实现正确                                                                 │
│                                                                                     │
│      ⚠️ 建议项:                                                                     │
│      - 可增加输入验证                                                               │
│      - 建议添加错误处理                                                             │
│                                                                                     │
│      请皇上定夺：                                                                   │
│      [1] 通过，接受交付                                                             │
│      [2] 打回，修复建议项后重新提交"                                                │
│                                                                                     │
│  👤 用户: "通过"                                                                    │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  阶段 6: 交付                                                                       │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "启奏皇上，项目已全部完成！                                                     │
│                                                                                     │
│      【交付清单】                                                                   │
│      📁 源代码: /projects/PRJ-001/src/                                              │
│      📄 技术文档: /projects/PRJ-001/docs/                                           │
│      📊 测试报告: /projects/PRJ-001/reports/                                        │
│                                                                                     │
│      项目已归档，随时可查阅。                                                       │
│      感谢皇上信任，微臣告退。"                                                      │
│                                                                                     │
│  👤 用户: ✅ 项目完成！                                                             │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 四、Bug 报告处理流程

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              Bug 报告：用户体验流程                                  │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  👤 用户: "登录功能有问题，验证逻辑不对"                                            │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  Step 1: Conductor 分析问题                                                         │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "微臣收到，正在分析问题..."                                                     │
│                                                                                     │
│     [调用钦天监扫描相关代码]                                                        │
│                                                                                     │
│     分析结果:                                                                       │
│     ┌─────────────────────────────────────────────────────────────┐                │
│     │  问题层面判断                                               │                │
│     ├─────────────────────────────────────────────────────────────┤                │
│     │                                                             │                │
│     │  ❓ 是代码写错了？                                          │                │
│     │     → 检查: 验证函数逻辑                                    │                │
│     │     → 发现: 正则表达式写错了 ⚠️                             │                │
│     │                                                             │                │
│     │  ❓ 是设计有问题？                                          │                │
│     │     → 检查: 验证规则定义                                    │                │
│     │     → 发现: 规则定义不清晰 ⚠️                               │                │
│     │                                                             │                │
│     │  结论: 设计层 + 代码层 双重问题                             │                │
│     │                                                             │                │
│     └─────────────────────────────────────────────────────────────┘                │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "启奏皇上，问题分析完成：                                                       │
│                                                                                     │
│      问题类型: Bug                                                                  │
│      问题层面: 设计层 + 代码层                                                      │
│      相关文件: auth-service.ts, validation-rules.md                                 │
│                                                                                     │
│      处理方案:                                                                      │
│      1. 先由工部尚书（Spec Agent）明确验证规则                                      │
│      2. 再由工部侍郎（Code Agent）按新规则修复代码                                  │
│      3. 最后由工部主事（Test Agent）验证修复结果                                    │
│                                                                                     │
│      是否按此方案处理？"                                                            │
│                                                                                     │
│  👤 用户: "好的"                                                                    │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  Step 2: 执行修复                                                                   │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  📐 Spec Agent: "验证规则已明确：邮箱格式、密码长度>=8..."                          │
│       ↓                                                                             │
│  💻 Code Agent: "代码已按新规则修复，编译通过"                                      │
│       ↓                                                                             │
│  🧪 Test Agent: "验证通过，Bug 已修复"                                              │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  Step 3: 汇报结果                                                                   │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "启奏皇上，Bug 已修复完成！                                                     │
│                                                                                     │
│      修复内容:                                                                      │
│      - 明确了验证规则（邮箱格式、密码>=8位）                                        │
│      - 修复了正则表达式错误                                                         │
│      - 通过了所有测试用例                                                           │
│                                                                                     │
│      请皇上验收。"                                                                  │
│                                                                                     │
│  👤 用户: ✅ Bug 修复完成！                                                         │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 五、项目咨询流程

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              项目咨询：用户体验流程                                  │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  👤 用户: "这个项目是做什么的？"                                                    │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "微臣理解您想了解项目概况。                                                     │
│      现委派都察院御史为您说明。"                                                    │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  Level 1: 一句话说明                                                                │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🔍 Review Agent:                                                                   │
│     "启奏皇上，这是一个【任务管理 App】，                                           │
│      主要用于【个人日常任务的创建、管理和跟踪】。                                   │
│                                                                                     │
│      需要更详细的说明吗？"                                                          │
│                                                                                     │
│  👤 用户: "详细一点"                                                                │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  Level 2: 功能概览                                                                  │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🔍 Review Agent:                                                                   │
│     "【功能概览】                                                                   │
│                                                                                     │
│      ┌─────────────────────────────────────────────┐                               │
│      │              任务管理 App                   │                               │
│      ├─────────────────────────────────────────────┤                               │
│      │                                             │                               │
│      │  📝 任务管理        📅 日期管理             │                               │
│      │  ├─ 创建任务        ├─ 设置截止日期         │                               │
│      │  ├─ 编辑任务        └─ 日期提醒             │                               │
│      │  ├─ 删除任务                                │                               │
│      │  └─ 完成任务        🏷️ 分类管理             │                               │
│      │                     ├─ 创建分类             │                               │
│      │                     └─ 任务归类             │                               │
│      │                                             │                               │
│      └─────────────────────────────────────────────┘                               │
│                                                                                     │
│      技术栈: React + Node.js + SQLite                                              │
│                                                                                     │
│      需要了解更多技术细节吗？"                                                      │
│                                                                                     │
│  👤 用户: "数据是怎么流转的？"                                                      │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  Level 4: 深入分析（上下游）                                                        │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  🔍 Review Agent:                                                                   │
│     [调用钦天监扫描数据流]                                                          │
│                                                                                     │
│     "【数据流向分析】                                                               │
│                                                                                     │
│      用户操作                                                                       │
│          │                                                                          │
│          ▼                                                                          │
│      ┌─────────┐      ┌─────────────┐      ┌──────────┐                            │
│      │ UI 组件 │ ───▶ │ TaskService │ ───▶ │ Database │                            │
│      │         │      │             │      │ (SQLite) │                            │
│      │ 输入:   │      │ 处理:       │      │ 存储:    │                            │
│      │ 任务数据│      │ 验证、转换  │      │ 持久化   │                            │
│      └─────────┘      └─────────────┘      └──────────┘                            │
│          ▲                                      │                                   │
│          │                                      │                                   │
│          └──────────── 查询结果 ────────────────┘                                   │
│                                                                                     │
│      简单说：                                                                       │
│      1. 用户在界面上操作（创建/编辑任务）                                           │
│      2. 数据经过 TaskService 处理和验证                                             │
│      3. 存入 SQLite 数据库                                                          │
│      4. 查询时反向流动，显示给用户"                                                 │
│                                                                                     │
│  👤 用户: "明白了，谢谢"                                                            │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 六、多项目并行管理

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              多项目并行：用户体验                                    │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  👤 用户: "我想同时开发两个项目"                                                    │
│                                                                                     │
│  🎼 Conductor:                                                                      │
│     "没问题！建议使用以下布局：                                                     │
│                                                                                     │
│      终端 1: 总控台（监控所有项目）                                                 │
│      终端 2: 项目 A 执行                                                            │
│      终端 3: 项目 B 执行"                                                           │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  终端布局                                                                           │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  ┌───────────────────────────────────────────────────────────────────────────────┐ │
│  │  终端 1: 总控台                                                               │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  🎼 Orchestra 多项目总控台                          活跃项目: 2          │ │ │
│  │  │                                                                         │ │ │
│  │  │  ┌───────┬────────────┬────────┬────────────────────┬─────────┬───────┐ │ │ │
│  │  │  │ ID    │ 名称       │ 状态   │ 进度               │ Agent   │ 终端  │ │ │ │
│  │  │  ├───────┼────────────┼────────┼────────────────────┼─────────┼───────┤ │ │ │
│  │  │  │PRJ-001│ 电商系统   │ 🔄进行 │ [████████░░] 60%   │ Code    │ T2    │ │ │ │
│  │  │  │PRJ-002│ 博客系统   │ 🔄进行 │ [██████████] 80%   │ Test    │ T3    │ │ │ │
│  │  │  └───────┴────────────┴────────┴────────────────────┴─────────┴───────┘ │ │ │
│  │  │                                                                         │ │ │
│  │  │  阶段流程:                                                              │ │ │
│  │  │  PRJ-001: Plan ✅ → Spec ✅ → Code(A) ✅ → Test ✅ → Code(B) 🔄          │ │ │
│  │  │  PRJ-002: Plan ✅ → Spec ✅ → Code ✅ → Test 🔄 → Review                 │ │ │
│  │  │                                                                         │ │ │
│  │  │  命令: list | status | switch <id> | pause <id> | dashboard            │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────┘ │ │
│  └───────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                     │
│  ┌─────────────────────────────────┐  ┌─────────────────────────────────┐         │
│  │  终端 2: PRJ-001 电商系统       │  │  终端 3: PRJ-002 博客系统       │         │
│  │  ┌───────────────────────────┐  │  │  ┌───────────────────────────┐  │         │
│  │  │ 📦 PRJ-001               │  │  │  │ 📦 PRJ-002               │  │         │
│  │  │ 阶段: Code Agent (B)     │  │  │  │ 阶段: Test Agent          │  │         │
│  │  │ ─────────────────────────│  │  │  │ ─────────────────────────│  │         │
│  │  │                          │  │  │  │                          │  │         │
│  │  │ 💻 Code Agent:           │  │  │  │ 🧪 Test Agent:           │  │         │
│  │  │ "正在实现商品模块..."    │  │  │  │ "运行测试中... 45/50"    │  │         │
│  │  │                          │  │  │  │                          │  │         │
│  │  │ [████████░░░░] 60%       │  │  │  │ [██████████░░] 80%       │  │         │
│  │  └───────────────────────────┘  │  │  └───────────────────────────┘  │         │
│  └─────────────────────────────────┘  └─────────────────────────────────┘         │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  用户可以在总控台执行的命令                                                         │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  👤 用户: "status PRJ-001"     → 查看电商系统详细状态                               │
│  👤 用户: "pause PRJ-002"      → 暂停博客系统                                       │
│  👤 用户: "switch PRJ-001"     → 切换关注到电商系统                                 │
│  👤 用户: "dashboard"          → 刷新仪表盘                                         │
│  👤 用户: "create 新项目"      → 创建第三个项目                                     │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 七、Agent 职责速查表

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              Agent 职责速查表                                        │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ┌─────────────┬────────────┬────────────────────────────────────────────────────┐ │
│  │    Agent    │    别名    │                      职责                          │ │
│  ├─────────────┼────────────┼────────────────────────────────────────────────────┤ │
│  │             │            │                                                    │ │
│  │ Conductor   │  内阁首辅  │  • 接收所有用户请求                                │ │
│  │             │            │  • 分析问题类型，路由到对应 Agent                  │ │
│  │             │            │  • 协调 Agent 之间的交接                           │ │
│  │             │            │  • 监控项目状态，处理异常                          │ │
│  │             │            │  • 支持多项目并行管理                              │ │
│  │             │            │                                                    │ │
│  ├─────────────┼────────────┼────────────────────────────────────────────────────┤ │
│  │             │            │                                                    │ │
│  │ Plan Agent  │ 翰林院学士 │  • 采访用户，理解需求                              │ │
│  │             │            │  • 生成 Plan Report（需求文档）                    │ │
│  │             │            │  • 确定功能优先级（P0/P1/P2）                      │ │
│  │             │            │  • 定义项目边界和验收标准                          │ │
│  │             │            │                                                    │ │
│  ├─────────────┼────────────┼────────────────────────────────────────────────────┤ │
│  │             │            │                                                    │ │
│  │ Spec Agent  │  工部尚书  │  • 技术方案设计                                    │ │
│  │             │            │  • 定义契约层（类型、接口、API）                   │ │
│  │             │            │  • 模块划分和规划                                  │ │
│  │             │            │  • 生成 Tech Spec + modules.yaml                   │ │
│  │             │            │                                                    │ │
│  ├─────────────┼────────────┼────────────────────────────────────────────────────┤ │
│  │             │            │                                                    │ │
│  │ Code Agent  │  工部侍郎  │  • Phase A: 创建契约层代码（类型、接口）           │ │
│  │             │            │  • Phase B: 填充实现层代码（业务逻辑）             │ │
│  │             │            │  • 调用 Coder Skills 执行具体编码                  │ │
│  │             │            │  • 编译验证，确保 0 错误                           │ │
│  │             │            │                                                    │ │
│  ├─────────────┼────────────┼────────────────────────────────────────────────────┤ │
│  │             │            │                                                    │ │
│  │ Test Agent  │  工部主事  │  • 契约验收（Phase A 后）                          │ │
│  │             │            │  • 最终验收（Phase B 后）                          │ │
│  │             │            │  • 功能验证、质量评分                              │ │
│  │             │            │  • 锁定契约，保护接口不被修改                      │ │
│  │             │            │                                                    │ │
│  ├─────────────┼────────────┼────────────────────────────────────────────────────┤ │
│  │             │            │                                                    │ │
│  │Review Agent │ 都察院御史 │  • 代码审查（质量、安全、规格）                    │ │
│  │             │            │  • 项目说明（帮用户理解项目）                      │ │
│  │             │            │  • 最终交付确认                                    │ │
│  │             │            │  • 上下游分析、可视化图表                          │ │
│  │             │            │                                                    │ │
│  └─────────────┴────────────┴────────────────────────────────────────────────────┘ │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 八、用户决策点总览

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                          用户需要做决策的关键节点                                    │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  整个流程中，用户需要在以下节点做出决策：                                           │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │  ① 项目启动确认                                                             │   │
│  │     时机: Conductor 接收需求后                                              │   │
│  │     决策: 是否开始项目？                                                    │   │
│  │     选项: [开始] [取消] [修改需求]                                          │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                          ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │  ② 需求确认                                                                 │   │
│  │     时机: Plan Agent 完成需求采访后                                         │   │
│  │     决策: Plan Report 是否准确？                                            │   │
│  │     选项: [确认] [修改] [补充]                                              │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                          ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │  ③ 技术方案确认                                                             │   │
│  │     时机: Spec Agent 完成设计后                                             │   │
│  │     决策: 技术方案是否可接受？                                              │   │
│  │     选项: [可以] [调整] [换方案]                                            │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                          ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │  ④ 审查结果决策                                                             │   │
│  │     时机: Review Agent 完成审查后                                           │   │
│  │     决策: 是否接受交付？                                                    │   │
│  │     选项: [通过，接受交付] [打回修改]                                       │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                          ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │  ⑤ 异常处理决策                                                             │   │
│  │     时机: 流程中出现问题时                                                  │   │
│  │     决策: 如何处理异常？                                                    │   │
│  │     选项: [重试] [打回某阶段] [修改需求] [终止项目]                         │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  关键原则：用户说了才算                                                             │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  • 系统不会擅自做重大决策                                                           │
│  • 每个关键节点都会请求用户确认                                                     │
│  • 用户可以随时暂停、打回、修改                                                     │
│  • 异常情况一定会上报用户                                                           │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 九、一图看懂 Orchestra

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                          🎼 Orchestra 一图看懂                                      │
│                                                                                     │
│  ┌───────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                               │ │
│  │                              👤 用户（皇上）                                  │ │
│  │                                   │                                           │ │
│  │                    ┌──────────────┴──────────────┐                           │ │
│  │                    ▼                             ▼                           │ │
│  │              "新项目/迭代"                  "问题/咨询"                       │ │
│  │                    │                             │                           │ │
│  │                    └──────────────┬──────────────┘                           │ │
│  │                                   ▼                                           │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                    🎼 Conductor（内阁首辅）                              │ │ │
│  │  │                         分析 → 路由 → 监控                              │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────┘ │ │
│  │                                   │                                           │ │
│  │         ┌─────────────────────────┼─────────────────────────┐               │ │
│  │         ▼                         ▼                         ▼               │ │
│  │                                                                               │ │
│  │    ╔═══════════════════════════════════════════════════════════════════╗     │ │
│  │    ║                      开发流水线                                   ║     │ │
│  │    ╠═══════════════════════════════════════════════════════════════════╣     │ │
│  │    ║                                                                   ║     │ │
│  │    ║   📋 Plan    📐 Spec    💻 Code     🧪 Test     🔍 Review        ║     │ │
│  │    ║   翰林学士   工部尚书   工部侍郎    工部主事    都察院御史        ║     │ │
│  │    ║      │          │          │           │           │             ║     │ │
│  │    ║      ▼          ▼          ▼           ▼           ▼             ║     │ │
│  │    ║   需求采集   技术设计   契约→实现   质量验收    审查说明         ║     │ │
│  │    ║      │          │          │           │           │             ║     │ │
│  │    ║      └──────────┴──────────┴───────────┴───────────┘             ║     │ │
│  │    ║                           │                                       ║     │ │
│  │    ╚═══════════════════════════╪═══════════════════════════════════════╝     │ │
│  │                                │                                             │ │
│  │                                ▼                                             │ │
│  │    ┌───────────────────────────────────────────────────────────────────┐     │ │
│  │    │                    🛠️ Skills（能力支持）                          │     │ │
│  │    │                                                                   │     │ │
│  │    │   📜 史官 ─ 记录      🔭 钦天监 ─ 扫描      📐 将作监 ─ 规划     │     │ │
│  │    │                                                                   │     │ │
│  │    │   🔒 契约守卫 ─ 锁定契约，保护接口                                │     │ │
│  │    │                                                                   │     │ │
│  │    │   💻 Coder Skills ─ 具体编码实现                                  │     │ │
│  │    │                                                                   │     │ │
│  │    └───────────────────────────────────────────────────────────────────┘     │ │
│  │                                │                                             │ │
│  │                                ▼                                             │ │
│  │                          ✅ 交付成果                                         │ │
│  │                                                                               │ │
│  └───────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                     │
│  ════════════════════════════════════════════════════════════════════════════════  │
│  核心理念                                                                           │
│  ════════════════════════════════════════════════════════════════════════════════  │
│                                                                                     │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐   │
│  │  用户至上      │  │  契约先行      │  │  质量保障      │  │  全程留痕      │   │
│  │                │  │                │  │                │  │                │   │
│  │  关键决策      │  │  先定接口      │  │  多层验收      │  │  史官记录      │   │
│  │  用户拍板      │  │  再写实现      │  │  层层把关      │  │  可追溯        │   │
│  └────────────────┘  └────────────────┘  └────────────────┘  └────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 十、快速参考卡

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              Orchestra 快速参考卡                                    │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  【我想做什么】                    【系统会怎么做】                                 │
│  ──────────────────────────────────────────────────────────────────────────────────│
│                                                                                     │
│  "做个新项目"                     → Plan → Spec → Code → Test → Review → 交付      │
│                                                                                     │
│  "加个功能"                       → 评估影响 → 从合适阶段开始                       │
│                                                                                     │
│  "有 bug"                         → 分析层面 → 路由修复 → 验证                      │
│                                                                                     │
│  "这是什么？"                     → Review Agent 项目说明                           │
│                                                                                     │
│  "进度怎样？"                     → Conductor 直接回答                              │
│                                                                                     │
│  "不对！"                         → 分析差异 → 确定修正方案                         │
│                                                                                     │
│  "同时做两个"                     → 多终端并行 + 总控台监控                         │
│                                                                                     │
│  ══════════════════════════════════════════════════════════════════════════════════│
│                                                                                     │
│  【6 个 Agent】                                                                     │
│  Conductor（总指挥）→ Plan（需求）→ Spec（设计）→ Code（开发）→ Test（测试）→ Review │
│                                                                                     │
│  【89 条铁律】保障质量、防止虚报、确保流程                                          │
│                                                                                     │
│  【用户至上】关键决策都需要用户确认                                                 │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

